{% extends "tram/base.html" %}
{%block head %}
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>
{%endblock%}
{% block content %}
<div class="card-panel white">
    <h1>WIP Dashboard</h1>
    <div class="row">
        <div class="col s12 m6 l6">
            <div class="card-panel white">
                <figure class="highcharts-figure">
                    <div id="container"></div>
                    <p class="highcharts-description">
                        This pie chart shows how the chart legend can be used to provide
                        information about the individual slices.
                    </p>
                </figure>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block javascript %}

<script>
    function getAjaxData(){
        $.ajax({
            method: "GET",
            url: "/tram/api/dashboard_omlopen",
            success: function(response){
                highchartOmlopen(response)
            },
            error: function(error_data){
                console.log(error_data)
            },
        })
    }

    function highchartOmlopen(data){
        Highcharts.chart('container', {
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
                type: 'pie'
            },
            title: {
                text: 'Omlopen',
            },
            subtitle:{
                text: `Totaal aantal omlopen ${data.totale_omlopen}`
            },
            tooltip: {
                pointFormat: '<b>{point.percentage:.1f}% (= {point.omlopen} omlopen)</b>'
            },
            accessibility: {
                point: {
                    valueSuffix: '%'
                }
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: true,
                        format: '<b>{point.name}</b>: {point.percentage:.1f} %'
                    }
                }
            },
            series: [{
                name: 'Assets',
                colorByPoint: true,
                data: data.asset_array
            }]
        });
    }
    getAjaxData();
</script>
{% endblock %}