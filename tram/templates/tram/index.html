{% extends "tram/base.html" %}
{% block content %}
    <div class="card-panel white">
        <table>
            <tr>
                <th>Assetnummer</th>
                <th>Storing</th>
                <th>Count</th>
                <th>Tijdstip</th>
            </tr>
            {%for storing in storingen|dictsortreversed:"data.tijdstip"%}
                <tr>
                    <td>{{storing.assetnummer.assetnummer}}</td>
                    <td>{{storing.bericht}}</td>
                    <td>{{storing.som}}</td>
                    <td>{{storing.data.tijdstip}}</td>
                    <td>
                            <a href="{% url 'storing_gezien' storing.id  %}">Gezien</a>
                    </td>
                    <!-- <td>
                            {% url 'storing_deactiveren' storing.id as durl %}
                            <a href="#" onclick="swalDeactiveerStoring('{{ durl }}')">Deactiveren</a>
                    </td> -->
                </tr>
            {%endfor%}

        </table>
    </div>
{% endblock content%}

{% block javascript%}
    <script>
        function refresh(){
            location.href = window.location.href;
        }
        var aInterval = setInterval(refresh, 30000);
        window.onclick = function(){
            clearInterval(aInterval)
            aInterval = setInterval(refresh, 30000);;
        };

        function swalDeactiveerStoring(url){
            Swal.fire({
                title: 'Zeker weten?',
                text: "Door de storing te deactiveren worden geen nieuwe updates van deze storing getoond.",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Ja, deactiveren!'
              }).then((result) => {
                if (result.value) {
                        window.location = url;
                    }
                }
            )
        }
    </script>
{% endblock javascript%}